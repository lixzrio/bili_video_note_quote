# B站视频笔记引用插件测试指南

## 一、代码修改后重新加载插件

1. 在Edge浏览器中打开扩展管理页面 (`edge://extensions/`)
2. 找到已安装的「B站视频笔记引用」插件
3. 点击插件卡片上的 **刷新** 按钮，或直接按键盘上的 **F5** 键
4. 插件将重新加载，应用最新的代码更改

## 二、测试用例

### 1. 基础功能测试

**测试步骤：**
1. 打开任意B站视频页面，例如：
   - BV号格式：https://www.bilibili.com/video/BV1xx411c7mC/
   - AV号格式：https://www.bilibili.com/video/av73870498/
2. 点击浏览器工具栏中的插件图标
3. 验证插件弹出窗口中是否正确显示视频标题和链接

### 2. 复制链接功能测试

**测试步骤：**
1. 在插件弹出窗口中，点击「复制视频链接」按钮
2. 打开记事本或其他文本编辑器
3. 粘贴内容，验证是否成功复制了视频链接

### 3. 保存Markdown文件功能测试

**测试步骤：**
1. 在插件弹出窗口中，点击「保存为Markdown文件」按钮
2. 在文件保存对话框中，选择保存位置
3. 检查保存的Markdown文件是否包含：
   - 视频标题作为文档标题
   - 视频链接
   - 引用信息和时间戳
   - 笔记区域

## 三、测试用B站视频链接

以下是不同类型的B站视频链接，用于全面测试插件：

1. 标准视频：https://www.bilibili.com/video/BV1xx411c7mC/
2. 带特殊字符标题的视频：https://www.bilibili.com/video/BV1Gx411z75K/
3. 较长标题的视频：https://www.bilibili.com/video/BV1354y1k7XW/
4. AV号格式视频：https://www.bilibili.com/video/av73870498/
5. 收藏夹页面（应提示非视频页面）：https://space.bilibili.com/up主ID/favlist

## 四、常见问题排查

### 1. 插件无法获取视频信息

- **原因**：content script未能正确加载或执行
- **解决方法**：
  - 刷新B站视频页面
  - 在扩展管理页面重新加载插件
  - 检查浏览器控制台是否有错误信息

### 2. 保存文件失败

- **原因**：downloads API限制或浏览器安全设置
- **解决方法**：
  - 确认已在manifest.json中声明了"downloads"权限
  - 检查浏览器下载设置是否允许文件下载
  - 尝试点击浏览器右上角的下载图标，查看是否有被阻止的下载

### 3. 文件名包含特殊字符

- **原因**：视频标题可能包含不适合作为文件名的字符
- **解决方法**：
  - 插件已经实现了文件名清理功能，会自动替换不合法字符为下划线
  - 如果仍有问题，可查看`sanitizeFileName`函数的实现

## 五、查看调试信息

1. 在浏览器中打开扩展管理页面
2. 启用「开发者模式」
3. 点击插件卡片上的「背景页」或「Inspect views」按钮
4. 在弹出的开发者工具中，可以查看控制台输出和网络请求
5. 在B站视频页面，按F12打开开发者工具，切换到「控制台」标签查看content script的输出

## 六、插件功能总结

成功安装和测试的插件应具备以下功能：

- ✅ 自动识别B站视频页面并获取视频信息
- ✅ 提供复制视频链接到剪贴板功能
- ✅ 生成包含视频信息的Markdown文件并保存到本地
- ✅ 优雅处理各种特殊情况和错误
- ✅ 提供友好的用户界面和状态提示
